<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>äº”è¿å…­æ°”èƒå„¿è‚²åŒ–çŠ¶æ€åŠå·¨å¤§å„¿é£é™©è¯„ä¼°å·¥å…·</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Microsoft YaHei', sans-serif;
    background: linear-gradient(135deg, #f0f7ff 0%, #e6f0ff 100%);
    min-height: 100vh;
    padding: 20px;
    color: #2c3e50;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(31, 38, 135, 0.15);
    overflow: hidden;
}

.header {
    background: linear-gradient(135deg, #2c3e50 0%, #1a2530 100%);
    color: white;
    padding: 30px;
    text-align: center;
}

.header h1 {
    font-size: 2.2em;
    margin-bottom: 10px;
}

.header p {
    opacity: 0.85;
}

.input-section {
    padding: 30px;
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
}

.input-section h3 {
    text-align: center;
    margin-bottom: 25px;
    font-size: 1.3em;
}

.date-inputs {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 10px;
}

.date-inputs input {
    padding: 12px 15px;
    border: 1px solid #d0e0f0;
    border-radius: 8px;
    font-size: 16px;
    width: 120px;
    text-align: center;
    background: white;
}

/* å¹´ä»½æç¤ºæ ·å¼ */
.year-hint {
    text-align: center;
    margin-bottom: 20px;
    font-size: 0.9em;
    color: #64748b;
    background: #f1f5f9;
    padding: 8px 15px;
    border-radius: 8px;
    display: inline-block;
    margin: 0 auto 20px;
    border: 1px solid #e2e8f0;
}

.diabetes-select {
    margin: 20px auto 25px;
    text-align: center;
}

.diabetes-select select {
    padding: 10px 20px;
    border: 1px solid #d0e0f0;
    border-radius: 8px;
    font-size: 16px;
    background: white;
    min-width: 180px;
}

.query-btn {
    display: block;
    margin: 0 auto;
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    color: white;
    border: none;
    padding: 14px 40px;
    border-radius: 10px;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 6px 15px rgba(52, 152, 219, 0.3);
    font-weight: 500;
}

.query-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(52, 152, 219, 0.4);
}

.output-section {
    padding: 30px;
    min-height: 300px;
}

.result-card {
    background: #f8fafc;
    border-radius: 12px;
    padding: 25px;
    margin-bottom: 20px;
    border: 1px solid #e2e8f0;
}

.result-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.result-item {
    background: white;
    padding: 15px;
    border-radius: 8px;
    border-left: 4px solid #3498db;
}

.result-item .label {
    font-size: 0.9em;
    color: #64748b;
    margin-bottom: 5px;
}

.result-item .value {
    font-size: 1.1em;
    font-weight: 600;
}

.risk-assessment {
    margin-top: 25px;
    padding: 20px;
    border-radius: 12px;
}

.macrosomia-risk {
    background: #fff9e6;
    border: 1px solid #ffd166;
}

.no-risk-message {
    background: #e8f5e9;
    border: 1px solid #a5d6a7;
    text-align: center;
    padding: 20px;
}

.risk-level {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    font-weight: 600;
    margin-top: 10px;
    font-size: 1em;
}

.risk-increase {
    background: #f8d7da;
    color: #721c24;
}

.risk-decrease {
    background: #d4edda;
    color: #155724;
}

.loading {
    display: none;
    text-align: center;
    padding: 30px;
}

.loading-spinner {
    border: 4px solid rgba(200, 220, 240, 0.5);
    border-top: 4px solid #3498db;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 0 auto 15px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.reference-section {
    margin-top: 20px;
    padding: 25px;
    background: #f8fafc;
    border-top: 1px solid #e2e8f0;
}

.reference-section h3 {
    text-align: center;
    margin-bottom: 20px;
    color: #2c3e50;
}

.reference-section h4 {
    text-align: center;
    margin-bottom: 15px;
    color: #4a5568;
    font-size: 1em;
    font-weight: normal;
    background: #edf2f7;
    padding: 8px 15px;
    border-radius: 8px;
    display: inline-block;
}

.reference-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    max-height: 400px;
    overflow-y: auto;
    padding: 10px;
}

.reference-item {
    background: white;
    padding: 15px;
    border-radius: 8px;
    border-left: 4px solid #3498db;
    font-size: 0.9em;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.reference-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: all 0.2s ease;
}

.reference-item strong {
    display: block;
    margin-bottom: 8px;
    color: #2c3e50;
    font-size: 1.1em;
}

.wuyun-display {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 500;
    margin-right: 5px;
    font-size: 0.9em;
}

.wuyun-è§’- { background: #ffebee; color: #c62828; }
.wuyun-è§’+ { background: #e8f5e9; color: #2e7d32; }
.wuyun-å•†- { background: #fff3e0; color: #ef6c00; }
.wuyun-å•†+ { background: #f3e5f5; color: #6a1b9a; }
.wuyun-ç¾½- { background: #e3f2fd; color: #1565c0; }
.wuyun-ç¾½+ { background: #e0f2f1; color: #00695c; }
.wuyun-å¾µ- { background: #fce4ec; color: #880e4f; }
.wuyun-å¾µ+ { background: #fff3e0; color: #ff6f00; }
.wuyun-å®«- { background: #e8eaf6; color: #3949ab; }
.wuyun-å®«+ { background: #f1f8e9; color: #558b2f; }

.sitian-display, .zaiquan-display {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.85em;
    margin-right: 5px;
}

.liuqi-å°‘é˜´å›ç« { background: #ffebee; color: #c62828; }
.liuqi-é˜³æ˜ç‡¥é‡‘ { background: #e8f5e9; color: #2e7d32; }
.liuqi-å¤ªé˜´æ¹¿åœŸ { background: #fff3e0; color: #ef6c00; }
.liuqi-å¤ªé˜³å¯’æ°´ { background: #e3f2fd; color: #1565c0; }
.liuqi-å°‘é˜³ç›¸ç« { background: #f3e5f5; color: #6a1b9a; }
.liuqi-å¥é˜´é£æœ¨ { background: #e0f2f1; color: #00695c; }

/* å…è´£å£°æ˜éƒ¨åˆ†æ ·å¼ */
.disclaimer-section {
    margin-top: 20px;
    padding: 25px;
    background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
    border-top: 1px solid #ffe69c;
    border-radius: 0 0 15px 15px;
}

.disclaimer-section h3 {
    text-align: center;
    margin-bottom: 15px;
    color: #856404;
    font-size: 1.2em;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.disclaimer-content {
    background: rgba(255, 255, 255, 0.8);
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #ffc107;
    font-size: 0.95em;
    line-height: 1.6;
    color: #555;
}

.disclaimer-content p {
    margin-bottom: 10px;
}

.disclaimer-content strong {
    color: #856404;
    font-weight: 600;
}

.disclaimer-footer {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px dashed #ffe69c;
    text-align: center;
    color: #666;
    font-size: 0.9em;
    font-style: italic;
}

/* æ–°å¢æ ·å¼ï¼šèƒå­•è‚²åŒ–çŠ¶æ€æ˜¾ç¤º */
.taiyun-display {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.85em;
    margin-right: 5px;
}

.taiyun-è‚² { background: #e8f5e9; color: #2e7d32; }
.taiyun-é™ { background: #e3f2fd; color: #1565c0; }
.taiyun-é€‚ä¸­ { background: #f5f5f5; color: #616161; }
.taiyun-ä¸æˆ { background: #ffebee; color: #c62828; }
.taiyun-ä¸è‚² { background: #fff3e0; color: #ef6c00; }
.taiyun-è€— { background: #f3e5f5; color: #6a1b9a; }

/* æ—¶é—´åˆ†æ®µè¯´æ˜æ ·å¼ */
.time-period-explanation {
    text-align: center;
    margin-bottom: 20px;
    font-size: 0.9em;
    color: #4a5568;
    background: #edf2f7;
    padding: 10px 15px;
    border-radius: 8px;
    border-left: 4px solid #3498db;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

.time-period-explanation strong {
    color: #2c3e50;
}

@media (max-width: 768px) {
    .date-inputs {
        flex-direction: column;
    }
    .date-inputs input {
        width: 200px;
    }
    .header h1 {
        font-size: 1.8em;
    }
    .reference-grid {
        grid-template-columns: 1fr;
    }
    .disclaimer-section {
        padding: 20px;
    }
    .disclaimer-content {
        padding: 15px;
    }
    .time-period-explanation {
        font-size: 0.85em;
        padding: 8px 12px;
    }
}
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ğŸ¤° èƒå­•è‚²åŒ–åŠå·¨å¤§å„¿é£é™©è¯„ä¼°å·¥å…·</h1>
        <p>åŸºäºäº”è¿å…­æ°”ç†è®ºï¼ˆå¹²æ”¯å¹´ä»¥å¤§å¯’èŠ‚æ°”ä¸ºåˆ†ç•Œï¼‰</p>
    </div>
    
    <div class="input-section">
        <h3>è¯·è¾“å…¥å—å­•æ—¥æœŸï¼ˆå…¬å†ï¼‰</h3>
        <div class="date-inputs">
            <input type="number" id="yearInput" placeholder="å¹´ä»½" min="1900" max="3000" value="1987">
            <input type="number" id="monthInput" placeholder="æœˆä»½" min="1" max="12" value="1">
            <input type="number" id="dayInput" placeholder="æ—¥æœŸ" min="1" max="31" value="30">
        </div>
        
        <!-- æ·»åŠ å¹´ä»½æç¤º -->
        <div class="year-hint">ğŸ“… å¹´ä»½æ”¯æŒèŒƒå›´ï¼š1900å¹´ - 3000å¹´</div>
        
        <div class="diabetes-select">
            <label for="diabetesStatus">å¦Šå¨ æœŸç³–å°¿ç—…æƒ…å†µï¼š</label>
            <select id="diabetesStatus">
                <option value="no">æœªç½¹æ‚£å¦Šå¨ æœŸç³–å°¿ç—…</option>
                <option value="yes">å·²ç½¹æ‚£å¦Šå¨ æœŸç³–å°¿ç—…</option>
            </select>
        </div>
        
        <button class="query-btn" onclick="calculateRisk()">ğŸ” æŸ¥è¯¢é£é™©</button>
    </div>
    
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>æ­£åœ¨è®¡ç®—ä¸­...</p>
    </div>
    
    <div class="output-section" id="outputSection">
        <div class="no-risk-message">
            <p>è¯·è¾“å…¥å—å­•æ—¥æœŸå¹¶ç‚¹å‡»æŸ¥è¯¢æŒ‰é’®</p>
        </div>
    </div>
    
    <div class="reference-section">
        <h3>ğŸ“Š å…­åç”²å­èƒå­•è‚²åŒ–å‚è€ƒè¡¨</h3>
        <div class="time-period-explanation">
            <strong>æ—¶é—´åˆ†æ®µè¯´æ˜ï¼š</strong>æ¯å¹´æŒ‰ä¸Šä¸‹åŠå¹´åˆ’åˆ†ï¼Œä¸ŠåŠå¹´ä¸º1æœˆ20æ—¥ï¼ˆå¤§å¯’èŠ‚ï¼‰-7æœˆ20æ—¥ï¼Œä¸‹åŠå¹´ä¸º7æœˆ21æ—¥-æ¬¡å¹´1æœˆ19æ—¥
        </div>
        <div class="reference-grid" id="referenceGrid">
            <!-- åŠ¨æ€ç”Ÿæˆå‚è€ƒæ•°æ® -->
        </div>
    </div>
    
    <!-- æ•°æ®è¯´æ˜å’Œå…è´£å£°æ˜éƒ¨åˆ† -->
    <div class="disclaimer-section">
        <h3>ğŸ“‹ æ•°æ®è¯´æ˜ä¸å…è´£å£°æ˜</h3>
        <div class="disclaimer-content">
            <p><strong>ç†è®ºåŸºç¡€ï¼š</strong>æœ¬å·¥å…·åŸºäºã€Šé»„å¸å†…ç»ã€‹äº”è¿å…­æ°”ç†è®ºåŠä¸´åºŠå›é¡¾æ€§ç ”ç©¶æ•°æ®å¼€å‘ï¼Œæ—¨åœ¨é€šè¿‡ä¼ ç»Ÿä¸­åŒ»ç†è®ºæä¾›å­•æœŸé£é™©è¯„ä¼°å‚è€ƒã€‚</p>
            <p><strong>é£é™©è¯„ä¼°è¯´æ˜ï¼š</strong>æ ¹æ®äº”è¿å…­æ°”ç†è®ºï¼Œç‰¹åˆ«å…³æ³¨ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼š</p>
            <ul style="margin-left: 20px; margin-bottom: 10px;">
                <li>æœ¨è¿ä¸åŠä¹‹å¹´ï¼Œæœªç½¹æ‚£å¦Šå¨ æœŸç³–å°¿ç—…äººç¾¤ï¼Œå·¨å¤§å„¿é£é™©å‡é«˜</li>
                <li>æœ¨è¿å¤ªè¿‡ä¹‹å¹´ï¼Œç½¹æ‚£å¦Šå¨ æœŸç³–å°¿ç—…äººç¾¤ï¼Œå·¨å¤§å„¿é£é™©é™ä½</li>
            </ul>
            <p><strong>é‡è¦æç¤ºï¼š</strong>æœ¬å·¥å…·æä¾›çš„é£é™©è¯„ä¼°ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­ã€‚è¯·åŠ¡å¿…ç»“åˆä¸´åºŠæ£€æŸ¥ç»“æœå’ŒåŒ»ç”Ÿä¸“ä¸šå»ºè®®åˆ¶å®šå­•æœŸç®¡ç†æ–¹æ¡ˆã€‚</p>
            <p><strong>æ•°æ®æ¥æºï¼š</strong>åŒ—äº¬å¸‚ä¸­åŒ»è¯ç§‘æŠ€å‘å±•èµ„é‡‘é¡¹ç›®æ”¯æŒçš„ä¸´åºŠå›é¡¾æ€§ç ”ç©¶ã€‚</p>
        </div>
        <div class="disclaimer-footer">
            âš ï¸ æœ¬å·¥å…·ä»…ä¾›ä¸­åŒ»ç†è®ºç ”ç©¶å’Œä¸´åºŠå‚è€ƒä½¿ç”¨
        </div>
    </div>
</div>

<script>
// å¤©å¹²åœ°æ”¯æ•°ç»„
const tianGan = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
const diZhi = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];

// å¤©å¹²å¯¹åº”çš„å²è¿è§„åˆ™
const wuyunMap = {
    'ç”²': 'å®«+', // åœŸè¿å¤ªè¿‡
    'ä¹™': 'å•†-', // é‡‘è¿ä¸åŠ
    'ä¸™': 'ç¾½+', // æ°´è¿å¤ªè¿‡
    'ä¸': 'è§’-', // æœ¨è¿ä¸åŠ
    'æˆŠ': 'å¾µ+', // ç«è¿å¤ªè¿‡
    'å·±': 'å®«-', // åœŸè¿ä¸åŠ
    'åºš': 'å•†+', // é‡‘è¿å¤ªè¿‡
    'è¾›': 'ç¾½-', // æ°´è¿ä¸åŠ
    'å£¬': 'è§’+', // æœ¨è¿å¤ªè¿‡
    'ç™¸': 'å¾µ-'  // ç«è¿ä¸åŠ
};

// æ ¹æ®å¤©å¹²è·å–å²è¿
function getWuYun(gan) {
    return wuyunMap[gan] || 'æœªçŸ¥';
}

// åœ°æ”¯å¯¹åº”çš„å¸å¤©ã€åœ¨æ³‰å…³ç³»
const liuQiMap = {
    'å­': { sitian: 'å°‘é˜´å›ç«', zaiquan: 'é˜³æ˜ç‡¥é‡‘' },
    'ä¸‘': { sitian: 'å¤ªé˜´æ¹¿åœŸ', zaiquan: 'å¤ªé˜³å¯’æ°´' },
    'å¯…': { sitian: 'å°‘é˜³ç›¸ç«', zaiquan: 'å¥é˜´é£æœ¨' },
    'å¯': { sitian: 'é˜³æ˜ç‡¥é‡‘', zaiquan: 'å°‘é˜´å›ç«' },
    'è¾°': { sitian: 'å¤ªé˜³å¯’æ°´', zaiquan: 'å¤ªé˜´æ¹¿åœŸ' },
    'å·³': { sitian: 'å¥é˜´é£æœ¨', zaiquan: 'å°‘é˜³ç›¸ç«' },
    'åˆ': { sitian: 'å°‘é˜´å›ç«', zaiquan: 'é˜³æ˜ç‡¥é‡‘' },
    'æœª': { sitian: 'å¤ªé˜´æ¹¿åœŸ', zaiquan: 'å¤ªé˜³å¯’æ°´' },
    'ç”³': { sitian: 'å°‘é˜³ç›¸ç«', zaiquan: 'å¥é˜´é£æœ¨' },
    'é…‰': { sitian: 'é˜³æ˜ç‡¥é‡‘', zaiquan: 'å°‘é˜´å›ç«' },
    'æˆŒ': { sitian: 'å¤ªé˜³å¯’æ°´', zaiquan: 'å¤ªé˜´æ¹¿åœŸ' },
    'äº¥': { sitian: 'å¥é˜´é£æœ¨', zaiquan: 'å°‘é˜³ç›¸ç«' }
};

// æ ¹æ®åœ°æ”¯è·å–å¸å¤©ã€åœ¨æ³‰
function getLiuQi(zhi) {
    return liuQiMap[zhi] || { sitian: 'æœªçŸ¥', zaiquan: 'æœªçŸ¥' };
}

// å®Œæ•´çš„èƒå­•è‚²åŒ–æ•°æ®ï¼ˆæ ¹æ®æ–‡æ¡£è¡¨æ ¼æ•´ç†ï¼‰
const taiYunData = {
    // ç”²å­å¹´
    'ç”²å­': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¹™ä¸‘å¹´
    'ä¹™ä¸‘': {ä¸ŠåŠå¹´: 'é™ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ-ï¼‰'},
    // ä¸™å¯…å¹´
    'ä¸™å¯…': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ--ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ--ï¼‰'},
    // ä¸å¯å¹´
    'ä¸å¯': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // æˆŠè¾°å¹´
    'æˆŠè¾°': {ä¸ŠåŠå¹´: 'è‚²ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'è‚²ï¼ˆ+ï¼‰'},
    // å·±å·³å¹´
    'å·±å·³': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // åºšåˆå¹´
    'åºšåˆ': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // è¾›æœªå¹´
    'è¾›æœª': {ä¸ŠåŠå¹´: 'é™ï¼ˆ++ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²'},
    // å£¬ç”³å¹´
    'å£¬ç”³': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ--ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ--ï¼‰'},
    // ç™¸é…‰å¹´
    'ç™¸é…‰': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ç”²æˆŒå¹´
    'ç”²æˆŒ': {ä¸ŠåŠå¹´: 'è‚²ï¼ˆ++ï¼‰', ä¸‹åŠå¹´: 'è‚²ï¼ˆ++ï¼‰'},
    // ä¹™äº¥å¹´
    'ä¹™äº¥': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¸™å­å¹´
    'ä¸™å­': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¸ä¸‘å¹´
    'ä¸ä¸‘': {ä¸ŠåŠå¹´: 'é™ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ-ï¼‰'},
    // æˆŠå¯…å¹´
    'æˆŠå¯…': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ-ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ-ï¼‰'},
    // å·±å¯å¹´
    'å·±å¯': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // åºšè¾°å¹´
    'åºšè¾°': {ä¸ŠåŠå¹´: 'è‚²ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'è‚²ï¼ˆ+ï¼‰'},
    // è¾›å·³å¹´
    'è¾›å·³': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // å£¬åˆå¹´
    'å£¬åˆ': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ç™¸æœªå¹´
    'ç™¸æœª': {ä¸ŠåŠå¹´: 'é™ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ-ï¼‰'},
    // ç”²ç”³å¹´
    'ç”²ç”³': {ä¸ŠåŠå¹´: 'ä¸æˆ', ä¸‹åŠå¹´: 'è€—'},
    // ä¹™é…‰å¹´
    'ä¹™é…‰': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¸™æˆŒå¹´
    'ä¸™æˆŒ': {ä¸ŠåŠå¹´: 'è‚²', ä¸‹åŠå¹´: 'è‚²'},
    // ä¸äº¥å¹´
    'ä¸äº¥': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // æˆŠå­å¹´
    'æˆŠå­': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // å·±ä¸‘å¹´
    'å·±ä¸‘': {ä¸ŠåŠå¹´: 'é™', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ--ï¼‰'},
    // åºšå¯…å¹´
    'åºšå¯…': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ-ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ-ï¼‰'},
    // è¾›å¯å¹´
    'è¾›å¯': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // å£¬è¾°å¹´
    'å£¬è¾°': {ä¸ŠåŠå¹´: 'è‚²', ä¸‹åŠå¹´: 'è‚²'},
    // ç™¸å·³å¹´
    'ç™¸å·³': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ç”²åˆå¹´
    'ç”²åˆ': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¹™æœªå¹´
    'ä¹™æœª': {ä¸ŠåŠå¹´: 'é™ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ-ï¼‰'},
    // ä¸™ç”³å¹´
    'ä¸™ç”³': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ--ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ--ï¼‰'},
    // ä¸é…‰å¹´
    'ä¸é…‰': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // æˆŠæˆŒå¹´
    'æˆŠæˆŒ': {ä¸ŠåŠå¹´: 'è‚²ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'è‚²ï¼ˆ+ï¼‰'},
    // å·±äº¥å¹´
    'å·±äº¥': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // åºšå­å¹´
    'åºšå­': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // è¾›ä¸‘å¹´
    'è¾›ä¸‘': {ä¸ŠåŠå¹´: 'é™ï¼ˆ++ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²'},
    // å£¬å¯…å¹´
    'å£¬å¯…': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ--ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ--ï¼‰'},
    // ç™¸å¯å¹´
    'ç™¸å¯': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ç”²è¾°å¹´
    'ç”²è¾°': {ä¸ŠåŠå¹´: 'è‚²ï¼ˆ++ï¼‰', ä¸‹åŠå¹´: 'è‚²ï¼ˆ++ï¼‰'},
    // ä¹™å·³å¹´
    'ä¹™å·³': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¸™åˆå¹´
    'ä¸™åˆ': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¸æœªå¹´
    'ä¸æœª': {ä¸ŠåŠå¹´: 'é™ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ-ï¼‰'},
    // æˆŠç”³å¹´
    'æˆŠç”³': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ-ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ-ï¼‰'},
    // å·±é…‰å¹´
    'å·±é…‰': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // åºšæˆŒå¹´
    'åºšæˆŒ': {ä¸ŠåŠå¹´: 'è‚²ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'è‚²ï¼ˆ+ï¼‰'},
    // è¾›äº¥å¹´
    'è¾›äº¥': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // å£¬å­å¹´
    'å£¬å­': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ç™¸ä¸‘å¹´
    'ç™¸ä¸‘': {ä¸ŠåŠå¹´: 'é™ï¼ˆ+ï¼‰', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ-ï¼‰'},
    // ç”²å¯…å¹´
    'ç”²å¯…': {ä¸ŠåŠå¹´: 'ä¸æˆ', ä¸‹åŠå¹´: 'è€—'},
    // ä¹™å¯å¹´
    'ä¹™å¯': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // ä¸™è¾°å¹´
    'ä¸™è¾°': {ä¸ŠåŠå¹´: 'è‚²', ä¸‹åŠå¹´: 'è‚²'},
    // ä¸å·³å¹´
    'ä¸å·³': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // æˆŠåˆå¹´
    'æˆŠåˆ': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // å·±æœªå¹´
    'å·±æœª': {ä¸ŠåŠå¹´: 'é™', ä¸‹åŠå¹´: 'ä¸è‚²ï¼ˆ--ï¼‰'},
    // åºšç”³å¹´
    'åºšç”³': {ä¸ŠåŠå¹´: 'ä¸æˆï¼ˆ-ï¼‰', ä¸‹åŠå¹´: 'è€—ï¼ˆ-ï¼‰'},
    // è¾›é…‰å¹´
    'è¾›é…‰': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'},
    // å£¬æˆŒå¹´
    'å£¬æˆŒ': {ä¸ŠåŠå¹´: 'è‚²', ä¸‹åŠå¹´: 'è‚²'},
    // ç™¸äº¥å¹´
    'ç™¸äº¥': {ä¸ŠåŠå¹´: 'é€‚ä¸­', ä¸‹åŠå¹´: 'é€‚ä¸­'}
};

// æ ¹æ®å¹²æ”¯è·å–èƒå­•è‚²åŒ–æƒ…å†µï¼ˆè€ƒè™‘ä¸ŠåŠå¹´/ä¸‹åŠå¹´ï¼‰
function getTaiYun(ganZhiYear, month, day) {
    // è·å–èƒå­•è‚²åŒ–æ•°æ®
    const taiyun = taiYunData[ganZhiYear];
    
    if (!taiyun) {
        return 'æ­£å¸¸';
    }
    
    // åˆ¤æ–­æ˜¯ä¸ŠåŠå¹´è¿˜æ˜¯ä¸‹åŠå¹´
    // ä¸ŠåŠå¹´ï¼š1æœˆ20æ—¥-7æœˆ20æ—¥
    // ä¸‹åŠå¹´ï¼š7æœˆ21æ—¥-æ¬¡å¹´1æœˆ19æ—¥
    const isFirstHalf = isFirstHalfYear(month, day);
    
    return isFirstHalf ? taiyun.ä¸ŠåŠå¹´ : taiyun.ä¸‹åŠå¹´;
}

// åˆ¤æ–­æ—¥æœŸæ˜¯å¦å±äºä¸ŠåŠå¹´ï¼ˆ1æœˆ20æ—¥-7æœˆ20æ—¥ï¼‰
function isFirstHalfYear(month, day) {
    if (month === 1) {
        return day >= 20;
    } else if (month >= 2 && month <= 6) {
        return true;
    } else if (month === 7) {
        return day <= 20;
    } else {
        return false;
    }
}

// è·å–èƒå­•è‚²åŒ–çŠ¶æ€çš„CSSç±»
function getTaiYunClass(taiyunState) {
    if (taiyunState.includes('è‚²')) return 'è‚²';
    if (taiyunState.includes('é™')) return 'é™';
    if (taiyunState.includes('é€‚ä¸­')) return 'é€‚ä¸­';
    if (taiyunState.includes('ä¸æˆ')) return 'ä¸æˆ';
    if (taiyunState.includes('ä¸è‚²')) return 'ä¸è‚²';
    if (taiyunState.includes('è€—')) return 'è€—';
    return 'é€‚ä¸­';
}

// å¤§å¯’æ—¥æœŸè¡¨ï¼ˆæ‰©å±•åˆ°1900-3000å¹´ï¼‰
const dahanDates = {};

// åˆå§‹åŒ–å¤§å¯’æ—¥æœŸï¼ˆ1900-3000å¹´å¤§éƒ¨åˆ†ä¸º1æœˆ20æ—¥ï¼‰
for(let y = 1900; y <= 3000; y++) {
    dahanDates[y] = 20;
}

// ä¿®æ­£éƒ¨åˆ†å¹´ä»½çš„å¤§å¯’æ—¥æœŸ
const specialDahanDates = {
    '1900': 21, '1904': 21, '1908': 21, '1912': 21, '1916': 21,
    '1920': 21, '1924': 21, '1928': 21, '1932': 21, '1936': 21,
    '1940': 21, '1944': 21, '1948': 21, '1952': 21, '1956': 20,
    '1960': 20, '1964': 21, '1968': 21, '1972': 21, '1976': 21,
    '1980': 21, '1984': 21, '1988': 20, '1992': 20, '1996': 21,
    '2000': 21, '2004': 21, '2008': 21, '2012': 21, '2016': 20,
    '2020': 20, '2024': 20, '2028': 20, '2032': 21, '2036': 20,
    '2040': 20, '2044': 20, '2048': 20, '2052': 20, '2056': 20,
    '2060': 20, '2064': 20, '2068': 20, '2072': 20, '2076': 20,
    '2080': 20, '2084': 20, '2088': 20, '2092': 20, '2096': 20,
    '2100': 20, '2104': 20, '2108': 20, '2112': 20, '2116': 20,
    '2120': 20, '2124': 20, '2128': 20, '2132': 20, '2136': 20,
    '2140': 20, '2144': 20, '2148': 20, '2152': 20, '2156': 20,
    '2160': 20, '2164': 20, '2168': 20, '2172': 20, '2176': 20,
    '2180': 20, '2184': 20, '2188': 20, '2192': 20, '2196': 20,
    '2200': 21, '2204': 21, '2208': 21, '2212': 21, '2216': 21,
    '2220': 21, '2224': 21, '2228': 21, '2232': 21, '2236': 20,
    '2240': 20, '2244': 21, '2248': 21, '2252': 21, '2256': 21,
    '2260': 21, '2264': 21, '2268': 20, '2272': 20, '2276': 21,
    '2280': 21, '2284': 21, '2288': 21, '2292': 21, '2296': 20,
    '2300': 21, '2304': 21, '2308': 21, '2312': 21, '2316': 21,
    '2320': 21, '2324': 21, '2328': 21, '2332': 21, '2336': 20,
    '2340': 20, '2344': 21, '2348': 21, '2352': 21, '2356': 21,
    '2360': 21, '2364': 21, '2368': 20, '2372': 20, '2376': 21,
    '2380': 21, '2384': 21, '2388': 21, '2392': 21, '2396': 20,
    '2400': 21, '2404': 21, '2408': 21, '2412': 21, '2416': 21,
    '2420': 21, '2424': 21, '2428': 21, '2432': 21, '2436': 20,
    '2440': 20, '2444': 21, '2448': 21, '2452': 21, '2456': 21,
    '2460': 21, '2464': 21, '2468': 20, '2472': 20, '2476': 21,
    '2480': 21, '2484': 21, '2488': 21, '2492': 21, '2496': 20,
    '2500': 21, '2504': 21, '2508': 21, '2512': 21, '2516': 21,
    '2520': 21, '2524': 21, '2528': 21, '2532': 21, '2536': 20,
    '2540': 20, '2544': 21, '2548': 21, '2552': 21, '2556': 21,
    '2560': 21, '2564': 21, '2568': 20, '2572': 20, '2576': 21,
    '2580': 21, '2584': 21, '2588': 21, '2592': 21, '2596': 20,
    '2600': 21, '2604': 21, '2608': 21, '2612': 21, '2616': 21,
    '2620': 21, '2624': 21, '2628': 21, '2632': 21, '2636': 20,
    '2640': 20, '2644': 21, '2648': 21, '2652': 21, '2656': 21,
    '2660': 21, '2664': 21, '2668': 20, '2672': 20, '2676': 21,
    '2680': 21, '2684': 21, '2688': 21, '2692': 21, '2696': 20,
    '2700': 21, '2704': 21, '2708': 21, '2712': 21, '2716': 21,
    '2720': 21, '2724': 21, '2728': 21, '2732': 21, '2736': 20,
    '2740': 20, '2744': 21, '2748': 21, '2752': 21, '2756': 21,
    '2760': 21, '2764': 21, '2768': 20, '2772': 20, '2776': 21,
    '2780': 21, '2784': 21, '2788': 21, '2792': 21, '2796': 20,
    '2800': 21, '2804': 21, '2808': 21, '2812': 21, '2816': 21,
    '2820': 21, '2824': 21, '2828': 21, '2832': 21, '2836': 20,
    '2840': 20, '2844': 21, '2848': 21, '2852': 21, '2856': 21,
    '2860': 21, '2864': 21, '2868': 20, '2872': 20, '2876': 21,
    '2880': 21, '2884': 21, '2888': 21, '2892': 21, '2896': 20,
    '2900': 21, '2904': 21, '2908': 21, '2912': 21, '2916': 21,
    '2920': 21, '2924': 21, '2928': 21, '2932': 21, '2936': 20,
    '2940': 20, '2944': 21, '2948': 21, '2952': 21, '2956': 21,
    '2960': 21, '2964': 21, '2968': 20, '2972': 20, '2976': 21,
    '2980': 21, '2984': 21, '2988': 21, '2992': 21, '2996': 20
};

// åˆå¹¶ç‰¹æ®Šæ—¥æœŸ
for (const [year, day] of Object.entries(specialDahanDates)) {
    dahanDates[year] = day;
}

// è·å–æŒ‡å®šå¹´ä»½çš„å¤§å¯’æ—¥æœŸ
function getDahanDate(year) {
    return dahanDates[year] || 20;
}

// æ ¹æ®å…¬å†æ—¥æœŸè®¡ç®—å¹²æ”¯å¹´ä»½ï¼ˆä»¥å¤§å¯’ä¸ºåˆ†ç•Œï¼‰
function getGanZhiYear(year, month, day) {
    // è·å–å½“å¹´çš„å¤§å¯’æ—¥æœŸ
    const dahanDay = getDahanDate(year);
    
    // åˆ¤æ–­æ—¥æœŸæ˜¯å¦åœ¨å½“å¹´å¤§å¯’å½“å¤©æˆ–ä¹‹å
    const isOnOrAfterDahan = (month > 1) || (month === 1 && day >= dahanDay);
    
    // å¦‚æœåœ¨å½“å¹´å¤§å¯’å½“å¤©æˆ–ä¹‹åï¼Œä½¿ç”¨å½“å‰å¹´ï¼›å¦åˆ™ä½¿ç”¨å‰ä¸€å¹´
    const baseYear = isOnOrAfterDahan ? year : year - 1;
    
    // è®¡ç®—å¹²æ”¯ç´¢å¼•ï¼ˆä»¥1924å¹´ç”²å­å¹´ä¸ºåŸºå‡†ï¼‰
    const ganZhiIndex = (baseYear - 1924) % 60;
    const positiveIndex = ganZhiIndex >= 0 ? ganZhiIndex : ganZhiIndex + 60;
    
    const ganIndex = positiveIndex % 10;
    const zhiIndex = positiveIndex % 12;
    
    return tianGan[ganIndex] + diZhi[zhiIndex];
}

// è·å–60ç”²å­åˆ—è¡¨ï¼ˆä»1924å¹´ç”²å­å¹´å¼€å§‹ï¼‰
function generateAllGanZhiYears() {
    const ganZhiYears = [];
    for (let i = 0; i < 60; i++) {
        const ganIndex = i % 10;
        const zhiIndex = i % 12;
        ganZhiYears.push(tianGan[ganIndex] + diZhi[zhiIndex]);
    }
    return ganZhiYears;
}

// è¯„ä¼°å·¨å¤§å„¿é£é™©ï¼ˆåªè¯„ä¼°ä¸¤ç§æƒ…å†µï¼‰
function assessMacrosomiaRisk(wuyun, diabetesStatus) {
    let riskInfo = {
        showRisk: false,
        riskType: '',
        message: ''
    };
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºæœ¨è¿ä¸åŠä¹‹å¹´ï¼ˆwuyunä¸º'è§’-'ï¼‰ä¸”æœªæ‚£ç³–å°¿ç—…
    if (wuyun === 'è§’-' && diabetesStatus === 'no') {
        riskInfo.showRisk = true;
        riskInfo.riskType = 'increase';
        riskInfo.message = 'æœ¨è¿ä¸åŠä¹‹å¹´ï¼Œæœªç½¹æ‚£å¦Šå¨ æœŸç³–å°¿ç—…äººç¾¤ï¼Œå·¨å¤§å„¿é£é™©å‡é«˜';
    }
    // æ£€æŸ¥æ˜¯å¦ä¸ºæœ¨è¿å¤ªè¿‡ä¹‹å¹´ï¼ˆwuyunä¸º'è§’+'ï¼‰ä¸”å·²æ‚£ç³–å°¿ç—…
    else if (wuyun === 'è§’+' && diabetesStatus === 'yes') {
        riskInfo.showRisk = true;
        riskInfo.riskType = 'decrease';
        riskInfo.message = 'æœ¨è¿å¤ªè¿‡ä¹‹å¹´ï¼Œç½¹æ‚£å¦Šå¨ æœŸç³–å°¿ç—…äººç¾¤ï¼Œå·¨å¤§å„¿é£é™©é™ä½';
    }
    
    return riskInfo;
}

// ç”Ÿæˆå‚è€ƒè¡¨æ ¼
function generateReferenceTable() {
    const referenceGrid = document.getElementById('referenceGrid');
    const allGanZhiYears = generateAllGanZhiYears();
    
    const referenceHTML = allGanZhiYears.map(ganZhiYear => {
        // æå–å¤©å¹²åœ°æ”¯
        const gan = ganZhiYear.charAt(0);
        const zhi = ganZhiYear.charAt(1);
        
        // è·å–æ•°æ®
        const wuyun = getWuYun(gan);
        const liuQi = getLiuQi(zhi);
        const taiyunData = taiYunData[ganZhiYear];
        
        // è·å–å²è¿å¯¹åº”çš„CSSç±»
        const wuyunClass = `wuyun-${wuyun.replace('+', '+').replace('-', '-')}`;
        
        // è·å–èƒå­•è‚²åŒ–çŠ¶æ€
        const taiyunFirstHalf = taiyunData ? taiyunData.ä¸ŠåŠå¹´ : 'æ­£å¸¸';
        const taiyunSecondHalf = taiyunData ? taiyunData.ä¸‹åŠå¹´ : 'æ­£å¸¸';
        
        // è·å–èƒå­•è‚²åŒ–CSSç±»
        const taiyunFirstHalfClass = getTaiYunClass(taiyunFirstHalf);
        const taiyunSecondHalfClass = getTaiYunClass(taiyunSecondHalf);
        
        return `
            <div class="reference-item">
                <strong>${ganZhiYear}å¹´</strong>
                <div style="margin-top: 5px;">
                    <span class="wuyun-display ${wuyunClass}">${wuyun}</span>
                </div>
                <div style="margin-top: 8px;">
                    <span style="font-size: 0.85em; color: #64748b;">å¸å¤©ï¼š</span>
                    <span class="sitian-display liuqi-${liuQi.sitian}">${liuQi.sitian}</span>
                </div>
                <div style="margin-top: 5px;">
                    <span style="font-size: 0.85em; color: #64748b;">åœ¨æ³‰ï¼š</span>
                    <span class="zaiquan-display liuqi-${liuQi.zaiquan}">${liuQi.zaiquan}</span>
                </div>
                <div style="margin-top: 5px;">
                    <span style="font-size: 0.85em; color: #64748b;">ä¸ŠåŠå¹´ï¼š</span>
                    <span class="taiyun-display taiyun-${taiyunFirstHalfClass}">${taiyunFirstHalf}</span>
                </div>
                <div style="margin-top: 5px;">
                    <span style="font-size: 0.85em; color: #64748b;">ä¸‹åŠå¹´ï¼š</span>
                    <span class="taiyun-display taiyun-${taiyunSecondHalfClass}">${taiyunSecondHalf}</span>
                </div>
            </div>
        `;
    }).join('');
    
    referenceGrid.innerHTML = referenceHTML;
}

// ä¸»è®¡ç®—å‡½æ•°
function calculateRisk() {
    const year = parseInt(document.getElementById('yearInput').value);
    const month = parseInt(document.getElementById('monthInput').value);
    const day = parseInt(document.getElementById('dayInput').value);
    const diabetesStatus = document.getElementById('diabetesStatus').value;
    
    // éªŒè¯æ—¥æœŸ
    if (!year || !month || !day) {
        alert('è¯·è¾“å…¥å®Œæ•´çš„æ—¥æœŸï¼');
        return;
    }
    
    // éªŒè¯å¹´ä»½èŒƒå›´ï¼ˆ1900-3000å¹´ï¼‰
    if (year < 1900 || year > 3000) {
        alert('å¹´ä»½å¿…é¡»åœ¨1900-3000å¹´ä¹‹é—´ï¼');
        return;
    }
    
    if (month < 1 || month > 12) {
        alert('æœˆä»½å¿…é¡»åœ¨1-12ä¹‹é—´ï¼');
        return;
    }
    
    if (day < 1 || day > 31) {
        alert('æ—¥æœŸå¿…é¡»åœ¨1-31ä¹‹é—´ï¼');
        return;
    }
    
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    document.getElementById('loading').style.display = 'block';
    document.getElementById('outputSection').style.display = 'none';
    
    setTimeout(() => {
        // è·å–å¹²æ”¯å¹´ä»½ï¼ˆä»¥å¤§å¯’ä¸ºåˆ†ç•Œï¼‰
        const ganZhiYear = getGanZhiYear(year, month, day);
        
        // æå–å¤©å¹²åœ°æ”¯
        const gan = ganZhiYear.charAt(0);
        const zhi = ganZhiYear.charAt(1);
        
        // æ ¹æ®å¤©å¹²è·å–å²è¿
        const wuyun = getWuYun(gan);
        
        // æ ¹æ®åœ°æ”¯è·å–å¸å¤©ã€åœ¨æ³‰
        const liuQi = getLiuQi(zhi);
        
        // è·å–èƒå­•è‚²åŒ–æƒ…å†µï¼ˆè€ƒè™‘ä¸ŠåŠå¹´/ä¸‹åŠå¹´ï¼‰
        const taiyun = getTaiYun(ganZhiYear, month, day);
        
        // åˆ¤æ–­æ˜¯ä¸ŠåŠå¹´è¿˜æ˜¯ä¸‹åŠå¹´
        const isFirstHalf = isFirstHalfYear(month, day);
        const periodText = isFirstHalf ? 'ä¸ŠåŠå¹´ï¼ˆ1æœˆ20æ—¥-7æœˆ20æ—¥ï¼‰' : 'ä¸‹åŠå¹´ï¼ˆ7æœˆ21æ—¥-æ¬¡å¹´1æœˆ19æ—¥ï¼‰';
        
        // è·å–èƒå­•è‚²åŒ–CSSç±»
        const taiyunClass = getTaiYunClass(taiyun);
        
        // è¯„ä¼°å·¨å¤§å„¿é£é™©
        const macrosomiaRisk = assessMacrosomiaRisk(wuyun, diabetesStatus);
        
        // ç”Ÿæˆç»“æœHTML
        const resultHTML = `
            <div class="result-card">
                <h4>æŸ¥è¯¢ç»“æœ - ${year}å¹´${month}æœˆ${day}æ—¥</h4>
                <div class="result-grid">
                    <div class="result-item">
                        <div class="label">å…¬å†æ—¥æœŸ</div>
                        <div class="value">${year}å¹´${month}æœˆ${day}æ—¥</div>
                    </div>
                    <div class="result-item">
                        <div class="label">æ‰€å±æ—¶æ®µ</div>
                        <div class="value">${periodText}</div>
                    </div>
                    <div class="result-item">
                        <div class="label">å¹²æ”¯å¹´ä»½</div>
                        <div class="value">${ganZhiYear}å¹´</div>
                    </div>
                    <div class="result-item">
                        <div class="label">å²è¿ï¼ˆäº”éŸ³ï¼‰</div>
                        <div class="value">${wuyun}</div>
                    </div>
                    <div class="result-item">
                        <div class="label">å¸å¤©</div>
                        <div class="value">${liuQi.sitian}</div>
                    </div>
                    <div class="result-item">
                        <div class="label">åœ¨æ³‰</div>
                        <div class="value">${liuQi.zaiquan}</div>
                    </div>
                    <div class="result-item">
                        <div class="label">èƒå­•è‚²åŒ–æƒ…å†µ</div>
                        <div class="value">
                            <span class="taiyun-display taiyun-${taiyunClass}">${taiyun}</span>
                        </div>
                    </div>
                    <div class="result-item">
                        <div class="label">å¦Šå¨ æœŸç³–å°¿ç—…æƒ…å†µ</div>
                        <div class="value">${diabetesStatus === 'no' ? 'æœªç½¹æ‚£' : 'å·²ç½¹æ‚£'}</div>
                    </div>
                </div>
            </div>
            
            ${macrosomiaRisk.showRisk ? `
                <div class="risk-assessment macrosomia-risk">
                    <h4>å·¨å¤§å„¿ç½¹æ‚£é£é™©è¯„ä¼°</h4>
                    <div style="margin: 15px 0;">
                        <strong>è¯„ä¼°ç»“æœï¼š</strong>
                        <span class="risk-level ${macrosomiaRisk.riskType === 'increase' ? 'risk-increase' : 'risk-decrease'}">
                            ${macrosomiaRisk.riskType === 'increase' ? 'é£é™©å‡é«˜' : 'é£é™©é™ä½'}
                        </span>
                    </div>
                    <div style="margin-bottom: 15px;">${macrosomiaRisk.message}</div>
                    <div style="background: #e8f4fd; padding: 12px; border-radius: 8px; font-size: 0.9em;">
                        <strong>å»ºè®®ï¼š</strong><br>
                        ${macrosomiaRisk.riskType === 'increase' ? 
                            'åŠ å¼ºå­•æœŸç›‘æµ‹ï¼Œæ§åˆ¶é¥®é£Ÿï¼Œé€‚å½“è¿åŠ¨ï¼Œå®šæœŸäº§æ£€ï¼Œæ³¨æ„è¡€ç³–æ§åˆ¶ã€‚' : 
                            'æ³¨æ„å‡è¡¡è¥å…»ï¼Œä¿æŒé€‚åº¦è¿åŠ¨ï¼ŒæŒ‰æ—¶äº§æ£€ï¼Œç»§ç»­éµåŒ»å˜±æ§åˆ¶è¡€ç³–ã€‚'}
                    </div>
                </div>
            ` : `
                <div class="risk-assessment no-risk-message">
                    <h4>å·¨å¤§å„¿é£é™©è¯„ä¼°</h4>
                    <p>å½“å‰å¹´ä»½å’Œå¦Šå¨ æœŸç³–å°¿ç—…æƒ…å†µç»„åˆä¸‹ï¼Œå·¨å¤§å„¿é£é™©æ— ç‰¹æ®Šå˜åŒ–ã€‚</p>
                    <p>å»ºè®®ä¿æŒè‰¯å¥½ç”Ÿæ´»ä¹ æƒ¯ï¼Œå®šæœŸäº§æ£€å³å¯ã€‚</p>
                </div>
            `}
        `;
        
        document.getElementById('loading').style.display = 'none';
        document.getElementById('outputSection').style.display = 'block';
        document.getElementById('outputSection').innerHTML = resultHTML;
    }, 600);
}

// å›è½¦é”®è§¦å‘æŸ¥è¯¢
document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
        calculateRisk();
    }
});

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
window.addEventListener('DOMContentLoaded', () => {
    // ç”Ÿæˆå‚è€ƒè¡¨æ ¼
    generateReferenceTable();
    
    // æµ‹è¯•ç”¨ä¾‹
    console.log('æµ‹è¯•1987å¹´1æœˆ30æ—¥:', getGanZhiYear(1987, 1, 30)); // åº”è¯¥æ˜¯ä¸å¯
    console.log('1987å¹´ä¸å¯å²è¿:', getWuYun('ä¸')); // åº”è¯¥æ˜¯è§’-
    console.log('æµ‹è¯•2001å¹´1æœˆ30æ—¥:', getGanZhiYear(2001, 1, 30)); // åº”è¯¥æ˜¯åºšè¾°
    console.log('2001å¹´åºšè¾°å²è¿:', getWuYun('åºš')); // åº”è¯¥æ˜¯å•†+
});
</script>
</body>
</html>